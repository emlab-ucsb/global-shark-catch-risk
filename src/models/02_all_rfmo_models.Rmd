---
title: "Final ML Runs"
output: html_notebook
---

This notebook runs the complete hurdle models for RFMO dataset.

```{r message=FALSE, warning=FALSE, include=FALSE}
# General
library(raster)
library(sf)
library(fasterize)
library(scales)
library(knitr)
library(RColorBrewer)
library(readxl)
library(googledrive)
library(cowplot)
library(tidyverse)
library(sp)
library(rgdal)
library(geosphere)
library(paletteer)

# Neg Binomial Libraries
library(pscl)

# ML Libraries
library(tidymodels)
library(readr)
library(broom.mixed)
library(MultivariateRandomForest)
library(vroom)

options(scipen = 1000000)

# Get functions
source("../functions/func-all_rfmo_initial_models.R")
source("../functions/func-train_all_models.R")
source("../functions/func-train_test_split.R")

save_loc = "../../data/model-data/outputs/all-rfmo-models/"
```

```{r include=FALSE}
# Read in data... 
dat <- read.csv("../../data/model-data/inputs/all-rfmo-models/global_ll_data_5x5_count.csv") 
dat2 <- read.csv("../../data/model-data/inputs/all-rfmo-models/global_ll_data_5x5_mt_to_count.csv") 
dat3 <- read.csv("../../data/model-data/inputs/all-rfmo-models/global_ll_data_1x1_count.csv") 
dat4 <- read.csv("../../data/model-data/inputs/all-rfmo-models/global_ll_data_1x1_mt_to_count.csv") 
```

```{r}
all_rfmo_initial_models(data = dat, save_loc = paste0(save_loc, "5x5_count_"))
all_rfmo_initial_models(data = dat2, save_loc = paste0(save_loc, "5x5_mt_to_count_"))
all_rfmo_initial_models(data = dat3, save_loc = paste0(save_loc, "1x1_count_"))
all_rfmo_initial_models(data = dat4, save_loc = paste0(save_loc, "1x1_mt_to_count_"))
```


```{r}
# Run through models 
# train_all_models(data = dat %>% filter(rfmo == "WCPFC"), save_loc = save_loc)
```

```{r}
# files <- list.files(save_loc)
# for(file in files) {
#   name <- gsub("_trained_model.rds", "", file)
#   t <- readRDS(file.path(save_loc, file))
#   assign(name, t)
# } 
```

